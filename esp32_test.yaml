substitutions:
  device_name: esp32_test
  upper_device_name: ESP32 Test

esphome:
  name: $device_name
  platform: ESP32
  # board: esp32doit-devkit-v1
  # board: esp32dev
  board: wemos_d1_mini32

wifi: !include include/wifi.yaml

## Note: I had to enable "multicast routing" on my router for mDNS to work for the ESP32S Devkit-v1

captive_portal:

web_server:
  port: 80

# Enable logging
logger:
  level: DEBUG

# Enable Home Assistant API
# api:

ota:

mqtt: !include include/mqtt.yaml
      
switch:
  - platform: restart
    name: $upper_device_name Restart
    
sensor:
  - platform: wifi_signal
    name: $upper_device_name WiFi Signal
    update_interval: 60s

esp32_ble_tracker:
  # on_ble_advertise:
  #   then:
  #     - lambda: |-
  #         ESP_LOGD("ble_adv", "New BLE device");
  #         ESP_LOGD("ble_adv", "  address: %s", x.address_str().c_str());
  #         ESP_LOGD("ble_adv", "  name: %s", x.get_name().c_str());
  #         ESP_LOGD("ble_adv", "  Advertised service UUIDs:");
  #         for (auto uuid : x.get_service_uuids()) {
  #             ESP_LOGD("ble_adv", "    - %s", uuid.to_string().c_str());
  #         }
  #         ESP_LOGD("ble_adv", "  Advertised service data:");
  #         for (auto data : x.get_service_datas()) {
  #             ESP_LOGD("ble_adv", "    - %s: (length %i)", data.uuid.to_string().c_str(), data.data.size());
  #         }
  #         ESP_LOGD("ble_adv", "  Advertised manufacturer data:");
  #         for (auto data : x.get_manufacturer_datas()) {
  #             ESP_LOGD("ble_adv", "    - %s: (length %i)", data.uuid.to_string().c_str(), data.data.size());
  #         }